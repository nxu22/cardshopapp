<h1>Checkout</h1>

<%= form_with(model: @order, url: checkout_path, local: true) do |form| %>
  <h2>User Information</h2>
  <p>Name: <%= current_user.username %></p>
  <p>Email: <%= current_user.email %> <br> <small>We will send order and tracking information to this email.</small></p>
  <p>Shipping Address: <%= current_user.address %></p>
  <p>Province: <%= current_user.province.name %></p>

  <h2>Order Details</h2>
  <ul>
    <% @cart.cart_items.each do |item| %>
      <li>
        <%= item.product.name %> - Quantity: <%= item.quantity %> - Price: <%= number_to_currency(item.product.price) %>
      </li>
    <% end %>
  </ul>

  <h2>Tax Breakdown</h2>
  <p>PST: <%= number_to_currency(@pst) %></p>
  <p>GST: <%= number_to_currency(@gst) %></p>
  <p>HST: <%= number_to_currency(@hst) %></p>
  <% if @qst.present? %>
    <p>QST: <%= number_to_currency(@qst) %></p>
  <% end %>
  
  <p>Total Tax: <%= number_to_currency(@total_tax) %></p>
  <p>Total Price: <%= number_to_currency(@total_price) %></p>

  <h2>Payment Information</h2>
  <div class="form-group">
    <%= form.label :payment_method, "Payment Method" %>
    <%= form.select :payment_method, ['Credit Card', 'PayPal'], class: 'form-control' %>
  </div>
  
  <div class="form-group">
    <%= form.label :payment_details, "Payment Details" %>
    <%= form.text_field :payment_details, class: 'form-control' %>
  </div>

  <%= form.submit 'Place Order', class: 'btn btn-primary' %>
<% end %>
